# Stock Market Price Prediction using Multiple Linear Regression. (2023)
## Introduction 
Stock market is a marketplace where investors buy and sell stocks. As a platform of continuous stock exchanges, the stock market provides companies the opportunity to raise their capital and investors to gain profits from their investments. The stock values are impacted by various factors including news articles, public sentiment, changes in the market flow, political situation, and other unforeseen incidents. As the future is inherently unpredictable, predicting the future value of the stock market remains challenging. Given that, the high sensitivity and randomness of the market cause investors to face difficulty in making profit-worthy decisions. <br>

The pivotal focus of this project is to solve the following problem: investors encountering a high risk of facing losses from their investments, due to the volatility of the stock market. With the usage of a machine learning technique, this project aims to make predictions of the future values of the stock market, using large-scale datasets of past multiyear stock markets. The importance of building a predictive model of the stock market lies in identifying the patterns and trends of the stock market. Accordingly, investors are expected to be advantaged by making informed decisions that maximize profit from a wiser investment. 

## Dataset 
Two datasets were used: _sp500wiki.csv_ and _data.csv_. Firstly, _sp500wiki.csv_ contains the list of S&P 500 companies as of July 2022 and various metadata in tabular format. Secondly, _data.csv_ contains the stock price, trade volume, news events, and news sentiment for S&P companies during the period between October 2020 and July 2022. To be specific, 26 variables were recorded, including the following 4 features: "Open" (opening price on the day), "Close" (closing price of the day), "High" (highest price on that day), and "Low" (lowest price on that day). 

## Method 
MLR is suitable for predicting the stock market price for several reasons. Primarily, MLR is able to incorporate multiple variables, thereby capturing the combined impact of those variables. This allows modeling of the complex relationships between various factors and stock prices. Additionally, stock market prices inherently exhibit dependencies on past stock prices and events. In this context, the ability to incorporate the moving average underscores MLR’s suitability for handling the time series analysis.  

### Data Preprocessing
4 different models were developed, each focusing on predicting a single output variable. The output variable was chosen among the following 4 features: “Open” (opening price of the day), “Close” (closing price of the day), “High” (highest price on that day), and “Low” (lowest price on that day). For the input variables, multiple features were used. Firstly, the values for “Open”, “High”, “Low”, “Close”, “Adj Close”, “Volume”, “News - All News Volume”, “News - Volume” of the previous day were included. On top of that, the 5-day moving average (5DMA) of the chosen predicting feature was taken into account. When predicting the “Open” value, 5DMA for only the “Open” feature was used. When predicting the “High” value, 5DMA for only the “High” feature was used, and so on. 

Moving average is the average of the values of the previous N days. A study was conducted by Omkar Kulkarni to compare the accuracy of the linear regression model when using the moving average of 5-day, 10-day, 20-day, and 50-day. The model that was trained with 5DMA displayed the highest accuracy of 88%. This result implies that 5DMA can provide a more comprehensive indication of how the target feature has been changing in the previous 5 days (Kulkarni, 2020). Therefore, 5DMA was included as the input variable to enhance the performance of the model. 

Therefore, the function `createData()` receives 3 inputs: _symbol_, _feature_, and _dataset_. _Symbol_ represents the specific company we would like to investigate. _Feature_ indicates the value we would like to predict among “Open”, “High”, “Low”, and “Close”. _Dataset_ includes the given data for the stock market with the addition of the 5DMA values. The function returns two datasets that are separated into input variables (x values) and output variables (y values). 

### Model Building
The `linear_regression()` function creates the linear regression model. This function receives 3 inputs: _symbol_ (name of company), _feature_ (one feature chosen among ‘Open’, ‘High’, ‘Low’, and ‘Close’), and the _preprocessed dataset_. Through another function, `createData()` – a function that separates the processed data into input dataset and output dataset – the X dataset and Y dataset were initialized with the features needed for building the model. 

Subsequently, both the X dataset and Y dataset were split into a training set and a testing set. The splitting ratio was chosen as _0.8_ for training data and _0.2_ for testing data. As a result, 4 separate datasets were initialized: x training set, y training set, x testing set, and y testing set. All datasets underwent the normalization process. After all these preparation stages, the prediction model was trained with the x training and y training sets. This was achieved by using the built-in function from the scikit-learn library. The trained model was used to make predictions on the x testing set. 

## Evaluation 
As a measurement of accuracy, Root Mean Squared Error(RMSE) was chosen. RMSE is the average distance between the predicted value from the model and the actual value recorded in the dataset. Hence, RMSE provides a reliable indication of the fitness of the model. That is, a model with a low RMSE value suggests that the model can make predictions with high accuracy. Conversely, a high RMSE value implies that the model fails to make accurate predictions. 

